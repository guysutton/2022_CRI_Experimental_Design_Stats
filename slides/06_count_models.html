<!DOCTYPE html>
<html lang="en"><head>
<script src="06_count_models_files/libs/clipboard/clipboard.min.js"></script>
<script src="06_count_models_files/libs/quarto-html/tabby.min.js"></script>
<script src="06_count_models_files/libs/quarto-html/popper.min.js"></script>
<script src="06_count_models_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="06_count_models_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="06_count_models_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="06_count_models_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.2.269">

  <meta name="author" content="Guy F. Sutton">
  <title>05 - Count models</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="06_count_models_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="06_count_models_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="06_count_models_files/libs/revealjs/dist/theme/quarto.css" id="theme">
  <link href="06_count_models_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="06_count_models_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="06_count_models_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="06_count_models_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-captioned.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-captioned) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-captioned.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-captioned .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-captioned .callout-caption  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-captioned.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-captioned.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-caption {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-caption {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-caption {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-captioned .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-captioned .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-captioned) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-caption {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-caption {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-caption {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-caption {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-caption {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">05 - Count models</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Guy F. Sutton 
</div>
        <p class="quarto-title-affiliation">
            Centre for Biological Control<br>Rhodes University, South Africa<br>Email: g.sutton@ru.ac.za
          </p>
    </div>
</div>

</section>
<section id="gaussian-data-is-rare" class="slide level2">
<h2>Gaussian data is rare</h2>
<div class="cell" data-hash="06_count_models_cache/revealjs/unnamed-chunk-1_f7cbfcffd2d21d10aad62c88c1bead15">

</div>
<div>
<div style="font-size: 0.75em">
<ul>
<li class="fragment">All the analyses so far have assumed that we are dealing with normal (Gaussian) distributed data that can be measured as whole numbers with decimal places (e.g.&nbsp;height, weight, diameter).
<ul>
<li class="fragment">However, most data in the real world either do not conform to the normal distribution, or they cannot be measured as numbers with decimal places, and can’t be analysed with Gaussian models.</li>
<li class="fragment">For example:
<ul>
<li class="fragment">Counts (e.g.&nbsp;species abundances, days till an event) which are measured as integers (cannot take a decimal place),</li>
<li class="fragment">Binary data (e.g.&nbsp;dead/alive, 1/0, present/absent),</li>
<li class="fragment">Proportion data (e.g.&nbsp;proportion survival, anything measured on a scale of [0,1])</li>
</ul></li>
</ul></li>
<li class="fragment">But, GLM’s can easily be extended to fitting count models and proportion/binary data</li>
</ul>
</div>
</div>
</section>
<section id="count-data" class="slide level2">
<h2>Count data</h2>
<div>
<div style="font-size: 0.85em">
<ul>
<li class="fragment">Count data is ubiqutous in ecology.
<ul>
<li class="fragment">e.g.&nbsp;No.&nbsp;of FCM per fruit</li>
<li class="fragment">e.g.&nbsp;No.&nbsp;of ticks per zebra</li>
<li class="fragment">e.g.&nbsp;Abundances of impala per hectare in the Kruger National Park</li>
</ul></li>
<li class="fragment">Counts (or abundances) are defined as non-negative integers
<ul>
<li class="fragment">I.e. They cannot take a decimal place</li>
<li class="fragment">e.g.&nbsp;0 FCM per fruit, 7 ticks on a zebra, 385 impala per hectare</li>
<li class="fragment">NOT: 33.15 psyllids per leaf</li>
<li class="fragment">ALSO NOT: 27% of the flies dead</li>
</ul></li>
</ul>
</div>
</div>
</section>
<section id="counts-are-not-normal-literally" class="slide level2">
<h2>Counts are not normal (literally)</h2>
<div>
<div style="font-size: 0.75em">
<ul>
<li class="fragment">Counts typically do not conform to assumptions of normality for statistical tests
<ul>
<li class="fragment">Count data typically follows a strong mean-variance relationship</li>
<li class="fragment">In many count datasets, there are many zeros and small counts, and successively fewer larger counts</li>
</ul></li>
</ul>
</div>
</div>
<div class="fragment">
<div class="cell" data-hash="06_count_models_cache/revealjs/unnamed-chunk-2_999622185b60227912b4ac4eb948bafc">
<div class="cell-output-display">
<p><img data-src="06_count_models_files/figure-revealjs/unnamed-chunk-2-1.png" width="960"></p>
</div>
</div>
</div>
</section>
<section id="count-models" class="slide level2">
<h2>Count models</h2>
<div>
<div style="font-size: 0.75em">
<ul>
<li class="fragment">There are two basic options for modelling count data:
<ol type="1">
<li class="fragment"><span style="color:#FF0000">Poisson GLM</span> - The poisson distribution assumes the mean = variance.</li>
<li class="fragment"><span style="color:#0000FF">Negative binomial GLM</span> - Expects more variance than the Poisson. Variance &gt; mean.</li>
</ol></li>
</ul>
</div>
</div>
<div class="fragment">
<div class="cell" data-hash="06_count_models_cache/revealjs/unnamed-chunk-3_4ade927cc8d6527380af18a7498c1ba7">
<div class="cell-output-display">
<p><img data-src="06_count_models_files/figure-revealjs/unnamed-chunk-3-1.png" width="960"></p>
</div>
</div>
</div>
</section>
<section id="count-models-in-r" class="slide level2">
<h2>Count models in <code>R</code></h2>
<ul>
<li>Assuming our question is: <em>Does Y vary based on X?</em></li>
</ul>
<div class="fragment">
<ul>
<li><em>Poisson GLM</em>:</li>
</ul>
<p><code>mod_poisson &lt;- glm(Y ~ X, family = poisson(link = "log"), data = data)</code></p>
</div>
<div class="fragment">
<ul>
<li><em>Negative binomial GLM</em>:</li>
</ul>
<p><code>mod_nb &lt;- glmmTMB::glmmTMB(Y ~ X, family = nbinom2, data = data, REML = FALSE)</code></p>
</div>
</section>
<section id="an-example" class="slide level2">
<h2>An example</h2>
<div>
<div style="font-size: 0.75em">
<ul>
<li class="fragment">I have simulated some data representing 100 FCM females who have been measured (<code>body_length</code>), and the number of eggs in their ovaries recorded (<code>no_eggs</code>).
<ul>
<li class="fragment">We want to know whether there is a relationship between <code>body_length</code> and <code>no_eggs</code>?</li>
<li class="fragment">I have simulated the data so that:
<ul>
<li class="fragment">The expected <code>no_eggs</code> when <code>body_length</code> = 0 is 2.71 eggs. Obviously nonsense, but keep this value in mind for later.</li>
<li class="fragment">The <code>no_eggs</code> produced increases by a value of 2 (by a factor of 7)</li>
</ul></li>
</ul></li>
</ul>
</div>
</div>
<div class="cell" data-hash="06_count_models_cache/revealjs/unnamed-chunk-4_dd2c091b6f1e9e7f5726ee0633366782">

</div>
</section>
<section id="visualise-relationship" class="slide level2">
<h2>Visualise relationship</h2>

<img data-src="06_count_models_files/figure-revealjs/unnamed-chunk-5-1.png" width="768" class="r-stretch"></section>
<section id="distribution-of-counts" class="slide level2">
<h2>Distribution of counts</h2>

<img data-src="06_count_models_files/figure-revealjs/unnamed-chunk-6-1.png" width="768" class="r-stretch"></section>
<section id="fit-gaussian-glm" class="slide level2">
<h2>Fit gaussian GLM</h2>
<div style="font-size: 0.85em">
<div class="cell" data-hash="06_count_models_cache/revealjs/unnamed-chunk-7_b6d45c4f679fc98c08269b17f7a8178c">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>mod_gaussian <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb1-2"><a href="#cb1-2"></a>  no_eggs <span class="sc">~</span> body_length, </span>
<span id="cb1-3"><a href="#cb1-3"></a>  <span class="at">data =</span> data, </span>
<span id="cb1-4"><a href="#cb1-4"></a>  <span class="at">family =</span> <span class="fu">gaussian</span>(<span class="at">link =</span> <span class="st">"identity"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="any-concerns" class="slide level2">
<h2>Any concerns?</h2>
<div style="font-size: 0.65em">
<div class="cell" data-hash="06_count_models_cache/revealjs/unnamed-chunk-8_903bbcc422d2c7f88f120576aae556d5">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="fu">summary</span>(mod_gaussian)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = no_eggs ~ body_length, family = gaussian(link = "identity"), 
    data = data)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-15.794   -5.042   -0.359    4.339   13.692  

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   -6.113      1.265  -4.831 5.02e-06 ***
body_length   30.839      1.376  22.420  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for gaussian family taken to be 36.23324)

    Null deviance: 21763.4  on 99  degrees of freedom
Residual deviance:  3550.9  on 98  degrees of freedom
AIC: 646.77

Number of Fisher Scoring iterations: 2</code></pre>
</div>
</div>
</div>
<div class="fragment">
<div>
<div style="font-size: 0.65em">
<ul>
<li class="fragment">What does the (Intercept) value tell us in a Gaussian GLM?
<ul>
<li class="fragment">The expected mean value when <code>x</code> = 0</li>
<li class="fragment">So, in this example, the expected mean <code>no_eggs</code> when <code>body_length</code> = 0 is -5.12 eggs…</li>
<li class="fragment"><strong>Impossible - This model is clearly a bad fit to the data!!!</strong></li>
</ul></li>
</ul>
</div>
</div>
</div>
</section>
<section id="model-diagnostics" class="slide level2">
<h2>Model diagnostics</h2>
<div>
<ul>
<li class="fragment">Whenever you fit a model, you should always be evaluating how well the model fit the underlying data using <em>model diagnostics</em>.
<ul>
<li class="fragment">Diagnostics allow us to evaluate whether we captured the properties of the data adequately in our statistical model</li>
<li class="fragment">If the diagnostics show a poor model fit, the inferences we draw are usually going to be misleading and wrong</li>
</ul></li>
</ul>
</div>
</section>
<section id="dharma" class="slide level2">
<h2><code>DHARMa</code></h2>
<div>
<div style="font-size: 0.65em">
<ul>
<li class="fragment">The easiest way to perform model diagnostics in <code>R</code> is using the <code>DHARMa</code> package, which uses a simulation-based approach to assess model fits.
<ul>
<li class="fragment">You may have performed tests such as <code>Shapiro-Wilk</code>, <code>Bartlett's</code>, or <code>Levene's</code>, in the past?</li>
<li class="fragment">These tests are typically performed incorrectly when used, and do not have the right properties to allow you to actually assess model fit, in many cases.</li>
</ul></li>
<li class="fragment">To use <code>DHARMa</code>, all we done is pass the variable name containing the fitted GLM model to the <code>simulateResiduals</code> function:</li>
</ul>
</div>
</div>
<div class="fragment">
<p><code>DHARMa::simulateResiduals(fittedModel = model_name, plot = TRUE)</code></p>
</div>
</section>
<section id="dharma-1" class="slide level2">
<h2><code>DHARMa</code></h2>
<div style="font-size: 0.65em">
<ul>
<li>Let’s assess the fit of our Gaussian GLM, it will give you two plots by default:
<ul>
<li>QQplot</li>
<li>Residual vs Predicted plot</li>
</ul></li>
</ul>
</div>
<div class="fragment">
<div class="cell" data-hash="06_count_models_cache/revealjs/unnamed-chunk-9_280635669ed591129367106ffcca6a3c">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>DHARMa<span class="sc">::</span><span class="fu">simulateResiduals</span>(<span class="at">fittedModel =</span> mod_gaussian, <span class="at">plot =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="06_count_models_files/figure-revealjs/unnamed-chunk-9-1.png" width="768"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Object of Class DHARMa with simulated residuals based on 250 simulations with refit = FALSE . See ?DHARMa::simulateResiduals for help. 
 
Scaled residual values: 0.124 0.48 0.312 0.136 0.828 0.212 0.756 0.644 0.984 0.992 0.788 0.536 0.2 0.988 0.38 0.284 0.18 0.592 0.4 0 ...</code></pre>
</div>
</div>
</div>
</section>
<section id="residuals" class="slide level2">
<h2>Residuals</h2>
<div>
<div style="font-size: 0.65em">
<ul>
<li class="fragment">Residuals are the way we assess model fit:
<ul>
<li class="fragment">In general, residuals are defined as the <em>difference between the actual y value and the predicted y value from the fitted statistical model</em>
<ul>
<li class="fragment">In this example, the residual indicates the difference in the actual <code>no_eggs</code> versus the predicted <code>no_eggs</code> we derive from our Gaussian GLM.</li>
</ul></li>
</ul></li>
</ul>
</div>
</div>
<div class="fragment">
<div class="cell" data-hash="06_count_models_cache/revealjs/unnamed-chunk-10_3ae988aa802d4731674880bc63581aff">
<div class="cell-output-display">
<p><img data-src="06_count_models_files/figure-revealjs/unnamed-chunk-10-1.png" width="960"></p>
</div>
</div>
</div>
</section>
<section id="qqplot" class="slide level2">
<h2>QQplot</h2>
<div style="font-size: 0.65em">
<ul>
<li>The <code>QQplot</code> tells us how well the our model captured the underlying distribution of our data.
<ul>
<li>If the distribution we fit in our model (<code>family = gaussian</code>) is a good fit to the data, we will see the residuals lay <em>approximately</em> along the 1:1 dashed line.</li>
</ul></li>
</ul>
</div>

<img data-src="06_count_models_files/figure-revealjs/unnamed-chunk-11-1.png" width="768" class="r-stretch"></section>
<section id="qqplot-1" class="slide level2">
<h2>QQplot</h2>

<img data-src="06_count_models_files/figure-revealjs/unnamed-chunk-12-1.png" width="960" class="r-stretch quarto-figure-center"><div>
<div style="font-size: 0.55em">
<ul>
<li class="fragment">The <code>KS test</code> is a formal test of the fit,
<ul>
<li class="fragment">If <code>KS p = ns</code> then the data in our model is not significantly different from the distribution specified (<code>family = gaussian</code>),</li>
<li class="fragment">If <code>KS p &lt; 0.05</code> then the data in our model is <strong>significantly different</strong> from the distribution specified (<code>family = gaussian</code>), and we need to fit a different model</li>
<li class="fragment">Not very helpful for count models though because the Gaussian distribution and Poisson distribution can often look the same in these plots</li>
</ul></li>
</ul>
</div>
</div>
</section>
<section id="residual-vs-fitted-plot" class="slide level2">
<h2>Residual vs Fitted plot</h2>
<div>
<div style="font-size: 0.55em">
<ul>
<li class="fragment">The <code>Residual vs Fitted Plot</code> shows whether the relationship between our predictor variables and response variable is linear, and whether the variance is unequal in our data.
<ul>
<li class="fragment">Both evidence for a non-linear relationship and/or unequal variance would mean that the model we have fit is a poor choice for the data.</li>
<li class="fragment">Inspecting the plot below, we can see clear evidence for a non-linear relationship in the data (the lines are not horizontal), and unequal variance (the spread of the points for each x value is not equal).</li>
</ul></li>
</ul>
</div>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center" data-hash="06_count_models_cache/revealjs/unnamed-chunk-13_e17e2930e8c8c9a9d4c29b687007d4fb">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="06_count_models_files/figure-revealjs/unnamed-chunk-13-1.png" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="fit-poisson-glm" class="slide level2">
<h2>Fit Poisson GLM</h2>
<div style="font-size: 0.60em">
<p>Recall the general syntax to fit a Poisson GLM:</p>
<p><code>mod_poisson &lt;- glm(Y ~ X, family = poisson(link = "log"), data = data)</code></p>
</div>
<div class="fragment">
<div style="font-size: 0.60em">
<div class="cell" data-hash="06_count_models_cache/revealjs/unnamed-chunk-14_0a9a0db6d370c68df8b8037b81114dcc">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>mod_poisson <span class="ot">&lt;-</span> <span class="fu">glm</span>(no_eggs <span class="sc">~</span> body_length, </span>
<span id="cb6-2"><a href="#cb6-2"></a>                   <span class="at">data =</span> data, </span>
<span id="cb6-3"><a href="#cb6-3"></a>                   <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>))</span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="fu">summary</span>(mod_poisson)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = no_eggs ~ body_length, family = poisson(link = "log"), 
    data = data)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-2.76018  -0.66884  -0.03394   0.60373   2.22450  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  0.93107    0.08258   11.27   &lt;2e-16 ***
body_length  2.04343    0.07064   28.93   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 1165.015  on 99  degrees of freedom
Residual deviance:   75.898  on 98  degrees of freedom
AIC: 517.94

Number of Fisher Scoring iterations: 4</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="was-this-model-a-better-fit" class="slide level2">
<h2>Was this model a better fit?</h2>
<div style="font-size: 0.60em">
<ul>
<li>The Poisson GLM was a good fit.
<ul>
<li>The <code>QQplot</code> shows that our data are not significantly different from what would be expected under the Poisson distribution.</li>
<li>The <code>Residual vs Fitted Plot</code> clearly indicates that the Poisson GLM was able to capture the non-linear relationship between <code>no_eggs</code> and <code>body_length</code> adequately, and that it was able to capture the varation appropriately.</li>
</ul></li>
</ul>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center" data-hash="06_count_models_cache/revealjs/unnamed-chunk-15_73eb47e0b6842fbaad5d0a88b32364aa">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>DHARMa<span class="sc">::</span><span class="fu">simulateResiduals</span>(<span class="at">fittedModel =</span> mod_poisson, <span class="at">plot =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="06_count_models_files/figure-revealjs/unnamed-chunk-15-1.png" width="768"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Object of Class DHARMa with simulated residuals based on 250 simulations with refit = FALSE . See ?DHARMa::simulateResiduals for help. 
 
Scaled residual values: 0.2720664 0.02727726 0.5483345 0.335516 0.6982642 0.6108333 0.579616 0.4894552 0.9479631 0.9186634 0.2577797 0.640772 0.1424715 0.9480578 0.6418357 0.5434822 0.211667 0.9253077 0.5816072 0.004 ...</code></pre>
</div>
</div>
</div>
</section>
<section id="interpreting-the-model-output" class="slide level2">
<h2>Interpreting the model output</h2>
<div>
<div style="font-size: 0.70em">
<ul>
<li class="fragment">When working with the Poisson (and other count models, e.g.&nbsp;negative binomial), the interpretation of the model output is different to the Gaussian GLM.
<ul>
<li class="fragment">The reason being is that the Poisson model is modelling the response variable on the log scale, not the raw data scale.</li>
<li class="fragment">So, to interpret results from count models on the scale of the response variable (e.g.&nbsp;<code>no_eggs</code>), we need to exponentiate the results, using the <code>exp</code> function.</li>
</ul></li>
</ul>
</div>
</div>
</section>
<section id="exponentiating-the-intercept" class="slide level2">
<h2>Exponentiating the (Intercept)</h2>
<div style="font-size: 0.60em">
<div class="cell" data-hash="06_count_models_cache/revealjs/unnamed-chunk-16_78a3282ddd48f73ee5afdf0bf88e124b">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="fu">summary</span>(mod_poisson)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = no_eggs ~ body_length, family = poisson(link = "log"), 
    data = data)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-2.76018  -0.66884  -0.03394   0.60373   2.22450  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  0.93107    0.08258   11.27   &lt;2e-16 ***
body_length  2.04343    0.07064   28.93   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 1165.015  on 99  degrees of freedom
Residual deviance:   75.898  on 98  degrees of freedom
AIC: 517.94

Number of Fisher Scoring iterations: 4</code></pre>
</div>
</div>
</div>
<div class="fragment">
<div style="font-size: 0.60em">
<ul>
<li>The <code>Intercept</code> value is 0.93.
<ul>
<li>For the Gaussian GLM, we would say interpret this value as the mean <code>no_eggs</code> when <code>body_length</code> = 0 is equal 0.93 eggs.</li>
<li>For the Poisson GLM, we need to take <code>exp(0.93)</code> to transform this value into the <code>no_eggs</code> <code>body_length</code> = 0.</li>
<li>The expected mean <code>no_eggs</code> when <code>body_length</code> = 0 is 2.53 eggs</li>
</ul></li>
</ul>
</div>
</div>
<div class="fragment">
<div class="cell" data-hash="06_count_models_cache/revealjs/unnamed-chunk-17_ad12ac7b120a7c5794a931f314f617bf">
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept) 
   2.537217 </code></pre>
</div>
</div>
</div>
</section>
<section id="exponentiating-the-beta-coefficient" class="slide level2">
<h2>Exponentiating the beta coefficient</h2>
<div style="font-size: 0.60em">
<div class="cell" data-hash="06_count_models_cache/revealjs/unnamed-chunk-18_5f4b333b6f03f321f9e38ae96a934328">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="fu">summary</span>(mod_poisson)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = no_eggs ~ body_length, family = poisson(link = "log"), 
    data = data)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-2.76018  -0.66884  -0.03394   0.60373   2.22450  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  0.93107    0.08258   11.27   &lt;2e-16 ***
body_length  2.04343    0.07064   28.93   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 1165.015  on 99  degrees of freedom
Residual deviance:   75.898  on 98  degrees of freedom
AIC: 517.94

Number of Fisher Scoring iterations: 4</code></pre>
</div>
</div>
</div>
<div class="fragment">
<div>
<div style="font-size: 0.60em">
<ul>
<li class="fragment">The <span class="math inline">\(\beta\)</span><sub>1</sub> (the coefficient for the effect of <code>body_length</code>) value is 2.04.
<ul>
<li class="fragment">For the Gaussian GLM, we would say interpret this value as the increase in the <code>no_eggs</code> for a 1 unit increase in <code>body_length</code> is equal to 2.04 more eggs.</li>
<li class="fragment">For the Poisson GLM, we need to take <code>exp(2.04)</code> to transform this value to get the <strong>factor</strong> increase in the <code>no_eggs</code> for a 1 unit increase in <code>body_length</code> .</li>
<li class="fragment">The factor increase in the <code>no_eggs</code> for every 1 unit increase in <code>body_length</code> is 7.69x more eggs</li>
</ul></li>
</ul>
</div>
</div>
</div>
<div class="fragment">
<div class="cell" data-hash="06_count_models_cache/revealjs/unnamed-chunk-19_416b5e9bca1692b7bb6bba83a542a3ae">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(mod_poisson)[<span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>body_length 
   7.717063 </code></pre>
</div>
</div>
</div>
</section>
<section id="compare-gaussian-vs-poisson-glm" class="slide level2">
<h2>Compare Gaussian vs Poisson GLM</h2>
<div style="font-size: 0.60em">
<ul>
<li>This plot should hopefully show that fitting a Gaussian GLM to count data is usually going to produce nonsense results, and the predictions from these models will typically be very wrong and basically unusable</li>
</ul>
</div>
<div class="cell" data-layout-align="center" data-hash="06_count_models_cache/revealjs/unnamed-chunk-20_d69d98ae7c5e1945a2569d6c655144e1">

</div>
<div class="cell" data-hash="06_count_models_cache/revealjs/unnamed-chunk-21_565360dbc0e1d549e977f4209b478a93">

</div>

<img data-src="06_count_models_files/figure-revealjs/unnamed-chunk-22-1.png" width="960" class="r-stretch"></section>
<section id="hypothesis-testing" class="slide level2">
<h2>Hypothesis testing</h2>
<ul>
<li>Finally, performing hypothesis testing for Poisson GLM’s is exactly the same as for the Gaussian GLM
<ul>
<li>Fit a null model (a model without the predictor variable of interest)</li>
</ul></li>
</ul>
<div class="cell" data-hash="06_count_models_cache/revealjs/unnamed-chunk-23_15f57d102f339f8160444dc0da01be7a">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>mod_null <span class="ot">&lt;-</span> <span class="fu">glm</span>(no_eggs <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> data, <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="likelihood-ratio-test" class="slide level2">
<h2>Likelihood Ratio Test</h2>
<ul>
<li>We then perform a Likelihood Ratio Test</li>
</ul>
<div class="cell" data-hash="06_count_models_cache/revealjs/unnamed-chunk-24_d8166602f3444b2e7adfd3ac4ff8902d">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="fu">anova</span>(mod_null, mod_poisson, <span class="at">test =</span> <span class="st">"Chisq"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model 1: no_eggs ~ 1
Model 2: no_eggs ~ body_length
  Resid. Df Resid. Dev Df Deviance  Pr(&gt;Chi)    
1        99     1165.0                          
2        98       75.9  1   1089.1 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div>
<div style="font-size: 0.70em">
<ul>
<li class="fragment">There is a statistically significant relationship between FCM <code>body_length</code> and the <code>no_eggs</code> produced (X2 = 1089.1, df = 1, <em>P</em> &lt; 0.001).
<ul>
<li class="fragment">We know that one of the models was better than the other because the <em>P</em> &lt; 0.05.</li>
<li class="fragment">We then can tell that model 2 (<code>mod_poisson</code>) is the better model because it has a <strong>lower</strong> residual deviance (<code>Resid. Dev = 75.9</code>) than model 1 (<code>mod_null</code>) (<code>Resid. Dev = 1165.0</code>).</li>
</ul></li>
</ul>
</div>
</div>
</section>
<section id="write-up-results" class="slide level2">
<h2>Write-up results</h2>
<p>There is a statistically significant relationship between FCM <code>body_length</code> and the <code>no_eggs</code> produced (X2 = 1089.1, df = 1, <em>P</em> &lt; 0.001). For every 1 unit increase in FCM body length, the number of eggs produced per female, on average, increases by a factor of 7.69 (<span class="math inline">\(\beta\)</span><sub>1</sub> = 2.04) (Figure 1).</p>

<img data-src="06_count_models_files/figure-revealjs/unnamed-chunk-25-1.png" width="768" class="r-stretch"></section>
<section id="negative-binomial-distribution" class="slide level2">
<h2>Negative binomial distribution</h2>
<div style="font-size: 0.70em">
<ul>
<li>Another distribution that can be used for modelling count data is the <em>negative binomial (NB)</em> distribution.
<ul>
<li>As we saw earlier in this slide deck, the difference between the Poisson and NB distribution is the assumptions of the mean = variance vs mean &lt; variance.</li>
<li>In non-statistical terms, the NB data typically has a greater spread of data (spread across the x-axis) than the Poisson</li>
</ul></li>
</ul>
</div>

<img data-src="06_count_models_files/figure-revealjs/unnamed-chunk-26-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="fit-nb-glm" class="slide level2">
<h2>Fit NB GLM</h2>
<ul>
<li>Whenever you model count data, I would recommend to fit both a Poisson and NB model, and compare the results and model fits.</li>
</ul>
<div class="fragment">
<p>Recall the general syntax to fit a NB GLM:</p>
<p><code>mod_nb &lt;- glmmTMB::glmmTMB(Y ~ X, family = nbinom2, data = data)</code></p>
</div>
</section>
<section id="fit-nb-model" class="slide level2">
<h2>Fit NB model</h2>
<div style="font-size: 0.70em">
<ul>
<li>The interpretation, model diagnostics, and inference as exactly the same as for the Poisson GLM.
<ul>
<li>So, we won’t repeat all of that code, you can do that in your own time.</li>
</ul></li>
</ul>
</div>
<div style="font-size: 0.70em">
<div class="cell" data-layout-align="center" data-hash="06_count_models_cache/revealjs/unnamed-chunk-27_75fde6522ded53beaa82d50ee8a4a619">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>mod_nb <span class="ot">&lt;-</span> glmmTMB<span class="sc">::</span><span class="fu">glmmTMB</span>(no_eggs <span class="sc">~</span> body_length, <span class="at">data =</span> data, <span class="at">family =</span> nbinom2)</span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="fu">summary</span>(mod_nb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: nbinom2  ( log )
Formula:          no_eggs ~ body_length
Data: data

     AIC      BIC   logLik deviance df.resid 
   531.4    539.2   -262.7    525.4       97 


Dispersion parameter for nbinom2 family (): 3.76e+08 

Conditional model:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  0.89769    0.08096   11.09   &lt;2e-16 ***
body_length  2.06699    0.06775   30.51   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</div>
</section>
<section id="compare-poisson-vs-nb-glm" class="slide level2">
<h2>Compare Poisson vs NB GLM</h2>
<div style="font-size: 0.70em">
<ul>
<li>As per usual, we use the LRT
<ul>
<li>Strange result, right?</li>
<li>We can’t compare the poisson GLM fit with the <code>glm</code> function vs the NB model fit with the <code>glmmTMB</code> function</li>
</ul></li>
</ul>
</div>
<div class="cell" data-hash="06_count_models_cache/revealjs/unnamed-chunk-28_1e66c9aa29481bd8bfb797e28371154f">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="fu">anova</span>(mod_poisson, mod_nb, <span class="at">test =</span> <span class="st">"Chisq"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model: poisson, link: log

Response: no_eggs

Terms added sequentially (first to last)

            Df Deviance Resid. Df Resid. Dev  Pr(&gt;Chi)    
NULL                           99     1165.0              
body_length  1   1089.1        98       75.9 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="refit-poisson-using-glmmtmb" class="slide level2">
<h2>Refit Poisson using <code>glmmTMB</code></h2>
<div style="font-size: 0.70em">
<ul>
<li>We have to refit the Poisson GLM using <code>glmmTMB</code></li>
</ul>
</div>
<div style="font-size: 0.70em">
<div class="cell" data-hash="06_count_models_cache/revealjs/unnamed-chunk-29_d87160f06fb31a43c173206ac400866b">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>mod_poisson_glmmTMB <span class="ot">&lt;-</span> glmmTMB<span class="sc">::</span><span class="fu">glmmTMB</span>(no_eggs <span class="sc">~</span> body_length, <span class="at">data =</span> data, <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<div style="font-size: 0.70em">
<div class="cell" data-hash="06_count_models_cache/revealjs/unnamed-chunk-30_44aab296b379ece9a365c1c45a88ce83">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="fu">anova</span>(mod_poisson_glmmTMB, mod_nb, <span class="at">test =</span> <span class="st">"Chisq"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: data
Models:
mod_poisson_glmmTMB: no_eggs ~ body_length, zi=~0, disp=~1
mod_nb: no_eggs ~ body_length, zi=~0, disp=~1
                    Df    AIC    BIC  logLik deviance Chisq Chi Df Pr(&gt;Chisq)
mod_poisson_glmmTMB  2 517.94 523.15 -256.97   513.94                        
mod_nb               3                                           1           </code></pre>
</div>
</div>
</div>
</div>
<div class="fragment">
<div>
<div style="font-size: 0.70em">
<ul>
<li class="fragment">Now we can compare the Poisson vs NB model using LRT
<ul>
<li class="fragment">There is no evidence for a significant improvement in model fit when fitting the NB model versus the Poisson model (X2 = 0.50, df = 1, P = 0.477).</li>
<li class="fragment">In this case, you use the simpler Poisson model</li>
</ul></li>
</ul>
</div>
</div>
</div>
</section>
<section id="counts-model-with-a-categorical-predictor" class="slide level2">
<h2>Counts model with a categorical predictor</h2>
<div>
<div style="font-size: 0.70em">
<ul>
<li class="fragment">So far, we have been fitting models where the predictor variable (<code>body_length</code>) is numeric/continuous.</li>
<li class="fragment">But, we can easily fit counts models with a categorical/factor variable.
<ul>
<li class="fragment">E.g. If we take 40 malaise samples from each of 3 different farms (<code>farm</code>) (n = 120 total samples) and compare insect species richness (<code>sp_rich</code>)</li>
</ul></li>
</ul>
</div>
</div>
<div class="fragment">
<div style="font-size: 0.70em">
<div class="cell" data-hash="06_count_models_cache/revealjs/unnamed-chunk-31_7892ff34997fafd4ad2e26046d8b6164">

</div>
<div class="cell" data-layout-align="center" data-hash="06_count_models_cache/revealjs/unnamed-chunk-32_ca9633ef19949921e927490c3881810b">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="06_count_models_files/figure-revealjs/unnamed-chunk-32-1.png" width="576"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="fit-poisson-with-categorical-predictor" class="slide level2">
<h2>Fit Poisson with categorical predictor</h2>
<ul>
<li>The syntax to fit the model, diagnostics and hypothesis testing is the same as for fitting the model with a numeric predictor.</li>
</ul>
<div class="cell" data-hash="06_count_models_cache/revealjs/unnamed-chunk-33_3e097b5085732fdf61125a5636c75572">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>mod_poisson <span class="ot">&lt;-</span> <span class="fu">glm</span>(sp_rich <span class="sc">~</span> farm, </span>
<span id="cb27-2"><a href="#cb27-2"></a>                    <span class="at">data =</span> data, </span>
<span id="cb27-3"><a href="#cb27-3"></a>                    <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="interpretation-is-different" class="slide level2">
<h2>Interpretation is different</h2>
<div style="font-size: 0.60em">
<ul>
<li>Interpreting the model summary is a bit different.
<ul>
<li>Notice, how <code>farm_a</code> is missing?</li>
<li><code>R</code> is comparing <code>farm_b</code> and <code>farm_c</code> to <code>farm_a</code>, which is being treated as the reference level.</li>
<li>Not ideal…</li>
</ul></li>
</ul>
<div class="cell" data-hash="06_count_models_cache/revealjs/unnamed-chunk-34_70a6a923702dc286c7d202d7043f7fbf">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = sp_rich ~ farm, family = poisson(link = "log"), 
    data = data)

Deviance Residuals: 
   Min      1Q  Median      3Q     Max  
-5.422  -2.994  -1.092   1.648   8.201  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  3.68072    0.02510  146.63   &lt;2e-16 ***
farmfarm_b  -0.78205    0.04481  -17.45   &lt;2e-16 ***
farmfarm_c  -0.75622    0.04441  -17.03   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 1656.7  on 119  degrees of freedom
Residual deviance: 1211.5  on 117  degrees of freedom
AIC: 1781.2

Number of Fisher Scoring iterations: 5</code></pre>
</div>
</div>
</div>
</section>
<section id="multiple-comparisons" class="slide level2">
<h2>Multiple comparisons</h2>
<div>
<ul>
<li class="fragment">What is the solution?
<ul>
<li class="fragment">Multiple comparisons, which compares each level to each other, not just to a reference level like <code>summary</code>.</li>
<li class="fragment">After hypothesis testing, it allows us to tell which levels within a significant factor are different from one another.</li>
</ul></li>
</ul>
</div>
</section>
<section id="perform-multiple-comparisons" class="slide level2">
<h2>Perform multiple comparisons</h2>
<div style="font-size: 0.60em">
<ul>
<li>We already know that there were significant differences in insect species richness between farms, but we don’t know which farms were different from one another</li>
</ul>
</div>
<div class="fragment">
<div style="font-size: 0.60em">
<div class="cell" data-hash="06_count_models_cache/revealjs/unnamed-chunk-35_914d6a3dcb952aba272006320558e87b">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>emmeans<span class="sc">::</span><span class="fu">emmeans</span>(mod_poisson, </span>
<span id="cb29-2"><a href="#cb29-2"></a>                 <span class="at">specs =</span> pairwise <span class="sc">~</span> farm,</span>
<span id="cb29-3"><a href="#cb29-3"></a>                 )<span class="sc">$</span>contrasts</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast        estimate     SE  df z.ratio p.value
 farm_a - farm_b   0.7821 0.0448 Inf  17.454  &lt;.0001
 farm_a - farm_c   0.7562 0.0444 Inf  17.027  &lt;.0001
 farm_b - farm_c  -0.0258 0.0522 Inf  -0.495  0.8735

Results are given on the log (not the response) scale. 
P value adjustment: tukey method for comparing a family of 3 estimates </code></pre>
</div>
</div>
</div>
</div>
<div class="fragment">
<div>
<div style="font-size: 0.60em">
<ul>
<li class="fragment">The <code>estimate</code> column gives the <span class="math inline">\(\beta\)</span> co-efficient for each comparison, on the log scale.
<ul>
<li class="fragment">It gives the factor increase going from the first level to the second level, once we exponentiate the value
<ul>
<li class="fragment">e.g.&nbsp;The <code>estimate</code> for the <code>farm_a - farm_b</code> comparison is 0.913 (positive) and statistically significant (<em>P</em> &lt; 0.001), which tells us that insect richness is higher at <code>farm_a</code> than <code>farm_b</code>.</li>
<li class="fragment">Taking <code>exp(0.913)</code> gives us a value of 2.49.</li>
<li class="fragment">So, insect species richness is 2.49 times higher at <code>farm_a</code> than <code>farm_b</code>.</li>
</ul></li>
</ul></li>
</ul>
</div>
</div>
</div>
</section>
<section id="test-yourself" class="slide level2">
<h2>Test yourself</h2>
<div class="panel-tabset">
<ul id="tabset-1" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-1-1">Background</a></li><li><a href="#tabset-1-2">Data</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1">
<div style="font-size: 0.60em">
<ul>
<li>Given the dataset in the <code>Data</code> tab, consisting of 200 agar plates grown with 5 different growth media (40 plates per growth medium) (<code>growth_medium</code>) and the no. of fungal colonies counted per plate (<code>no_colonies</code>):
<ul>
<li>Should we be growing our fungal cultures on one particular growth medium, or is the no. of fungal colonies produced similar across all the growth media?</li>
<li>If we should be using a particular growth medium, which medium should we use?</li>
</ul></li>
</ul>
</div>
<div class="cell" data-hash="06_count_models_cache/revealjs/unnamed-chunk-36_7ef2d68f38733261a4e0affe57b8edc0">

</div>
<div class="cell" data-layout-align="center" data-hash="06_count_models_cache/revealjs/unnamed-chunk-37_3e77d1de91b00a87f41b039a6fbbb140">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="06_count_models_files/figure-revealjs/unnamed-chunk-37-1.png" width="576"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-2">
<div class="cell" data-hash="06_count_models_cache/revealjs/unnamed-chunk-38_f646c84e2e7c11dd97811207b65d525d">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="co"># Use package manager to check, install and load required packages</span></span>
<span id="cb31-2"><a href="#cb31-2"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">"pacman"</span>)) <span class="fu">install.packages</span>(<span class="st">"pacman"</span>)</span>
<span id="cb31-3"><a href="#cb31-3"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(</span>
<span id="cb31-4"><a href="#cb31-4"></a>  <span class="co"># List the packages you need below</span></span>
<span id="cb31-5"><a href="#cb31-5"></a>  tidyverse,</span>
<span id="cb31-6"><a href="#cb31-6"></a>  glmmTMB,</span>
<span id="cb31-7"><a href="#cb31-7"></a>  DHARMa</span>
<span id="cb31-8"><a href="#cb31-8"></a>)</span>
<span id="cb31-9"><a href="#cb31-9"></a></span>
<span id="cb31-10"><a href="#cb31-10"></a><span class="co"># Set seed</span></span>
<span id="cb31-11"><a href="#cb31-11"></a><span class="fu">set.seed</span>(<span class="dv">2021</span>)</span>
<span id="cb31-12"><a href="#cb31-12"></a></span>
<span id="cb31-13"><a href="#cb31-13"></a><span class="co"># Set sample size</span></span>
<span id="cb31-14"><a href="#cb31-14"></a>n <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb31-15"><a href="#cb31-15"></a></span>
<span id="cb31-16"><a href="#cb31-16"></a><span class="co"># Specify regression coefficients</span></span>
<span id="cb31-17"><a href="#cb31-17"></a>beta0 <span class="ot">&lt;-</span> <span class="dv">1</span>     <span class="co"># B0</span></span>
<span id="cb31-18"><a href="#cb31-18"></a>beta1 <span class="ot">&lt;-</span> <span class="dv">3</span>     <span class="co"># B1</span></span>
<span id="cb31-19"><a href="#cb31-19"></a></span>
<span id="cb31-20"><a href="#cb31-20"></a><span class="co"># Generate covariate values</span></span>
<span id="cb31-21"><a href="#cb31-21"></a>body_length <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="at">n=</span>n, <span class="at">min=</span><span class="dv">0</span>, <span class="at">max=</span><span class="fl">1.5</span>)</span>
<span id="cb31-22"><a href="#cb31-22"></a></span>
<span id="cb31-23"><a href="#cb31-23"></a><span class="co"># Compute mu's</span></span>
<span id="cb31-24"><a href="#cb31-24"></a>mu <span class="ot">&lt;-</span> <span class="fu">exp</span>(beta0 <span class="sc">+</span> beta1 <span class="sc">*</span> body_length)</span>
<span id="cb31-25"><a href="#cb31-25"></a></span>
<span id="cb31-26"><a href="#cb31-26"></a><span class="co"># X factor variable </span></span>
<span id="cb31-27"><a href="#cb31-27"></a>growth_medium <span class="ot">&lt;-</span> <span class="fu">rep</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>], <span class="at">each =</span> <span class="dv">40</span>)</span>
<span id="cb31-28"><a href="#cb31-28"></a></span>
<span id="cb31-29"><a href="#cb31-29"></a><span class="co"># Generate Y-values</span></span>
<span id="cb31-30"><a href="#cb31-30"></a>no_colonies <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="at">n=</span>n, <span class="at">lambda=</span>mu)</span>
<span id="cb31-31"><a href="#cb31-31"></a></span>
<span id="cb31-32"><a href="#cb31-32"></a><span class="co"># Data set</span></span>
<span id="cb31-33"><a href="#cb31-33"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(growth_medium, <span class="at">body_mass =</span> body_length, no_colonies) <span class="sc">%&gt;%</span></span>
<span id="cb31-34"><a href="#cb31-34"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">growth_medium =</span> <span class="fu">paste</span>(<span class="st">"medium"</span>,growth_medium, <span class="at">sep =</span> <span class="st">"_"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section class="slide level2">

<h3 id="plot-the-no.-of-colonies-by-growth-medium">Plot the no. of colonies by growth medium</h3>
<div class="panel-tabset">
<ul id="tabset-2" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-2-1">Plot</a></li><li><a href="#tabset-2-2">Code</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1">
<div class="cell" data-hash="06_count_models_cache/revealjs/unnamed-chunk-39_3f6f42679e52e5e9b61afbf9917366a4">
<div class="cell-output-display">
<p><img data-src="06_count_models_files/figure-revealjs/unnamed-chunk-39-1.png" width="768"></p>
</div>
</div>
</div>
<div id="tabset-2-2">
<div class="cell" data-hash="06_count_models_cache/revealjs/unnamed-chunk-40_66223982cc2b9007f838f7d4070fb704">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a>data <span class="sc">%&gt;%</span> </span>
<span id="cb32-2"><a href="#cb32-2"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> growth_medium, <span class="at">y =</span> no_colonies)) <span class="sc">+</span></span>
<span id="cb32-3"><a href="#cb32-3"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb32-4"><a href="#cb32-4"></a>  <span class="fu">labs</span>(</span>
<span id="cb32-5"><a href="#cb32-5"></a>    <span class="at">x =</span> <span class="st">"Growth medium"</span>,</span>
<span id="cb32-6"><a href="#cb32-6"></a>    <span class="at">y =</span> <span class="st">"No. of colonies"</span></span>
<span id="cb32-7"><a href="#cb32-7"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section class="slide level2">

<h3 id="plot-the-distribution-of-colony-counts-by-growth-medium">Plot the distribution of colony counts by growth medium</h3>
<div class="panel-tabset">
<ul id="tabset-3" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-3-1">Plot</a></li><li><a href="#tabset-3-2">Code</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1">
<div class="cell" data-layout-align="center" data-hash="06_count_models_cache/revealjs/unnamed-chunk-41_7d18d5a994d73eadf00fe3ecc59d8099">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="06_count_models_files/figure-revealjs/unnamed-chunk-41-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-3-2">
<div class="cell" data-layout-align="center" data-hash="06_count_models_cache/revealjs/unnamed-chunk-42_7e1ae374629aaec29f87d059dcf8fafa">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>data <span class="sc">%&gt;%</span> </span>
<span id="cb33-2"><a href="#cb33-2"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> no_colonies)) <span class="sc">+</span></span>
<span id="cb33-3"><a href="#cb33-3"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span> </span>
<span id="cb33-4"><a href="#cb33-4"></a>  <span class="fu">labs</span>(</span>
<span id="cb33-5"><a href="#cb33-5"></a>    <span class="at">x =</span> <span class="st">"No. of colonies"</span>,</span>
<span id="cb33-6"><a href="#cb33-6"></a>    <span class="at">y =</span> <span class="st">"Frequency"</span></span>
<span id="cb33-7"><a href="#cb33-7"></a>  ) <span class="sc">+</span></span>
<span id="cb33-8"><a href="#cb33-8"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> growth_medium, <span class="at">nrow =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="fit-gaussian-glm-not-100-necessary" class="slide level2">
<h2>Fit Gaussian GLM, not 100% necessary</h2>
<div style="font-size: 0.70em">
<div class="cell" data-hash="06_count_models_cache/revealjs/unnamed-chunk-43_c00681a380ec2fb530fa3ae016a59166">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a>mod_gaussian <span class="ot">&lt;-</span> <span class="fu">glm</span>(no_colonies <span class="sc">~</span> growth_medium, <span class="at">data =</span> data, <span class="at">family =</span> <span class="fu">gaussian</span>(<span class="at">link =</span> <span class="st">"identity"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="panel-tabset">
<ul id="tabset-4" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-4-1">Diagnostics plot</a></li><li><a href="#tabset-4-2">Code</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1">
<div class="cell" data-hash="06_count_models_cache/revealjs/unnamed-chunk-44_cd859fbe02b5b9112e2636970769d06f">
<div class="cell-output-display">
<p><img data-src="06_count_models_files/figure-revealjs/unnamed-chunk-44-1.png" width="960"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Object of Class DHARMa with simulated residuals based on 250 simulations with refit = FALSE . See ?DHARMa::simulateResiduals for help. 
 
Scaled residual values: 0.148 0.58 0.348 0.156 0.22 0.3 0.38 0.108 0.58 0.96 0.096 0.752 0.312 0.172 0.508 0.132 0.16 0.792 0.972 0.208 ...</code></pre>
</div>
</div>
</div>
<div id="tabset-4-2">
<div class="cell" data-hash="06_count_models_cache/revealjs/unnamed-chunk-45_e040ba35c9e2602d3c06348e246d790d">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a>mod_gaussian <span class="ot">&lt;-</span> <span class="fu">glm</span>(no_colonies <span class="sc">~</span> growth_medium, </span>
<span id="cb36-2"><a href="#cb36-2"></a>                    <span class="at">data =</span> data, </span>
<span id="cb36-3"><a href="#cb36-3"></a>                    <span class="at">family =</span> <span class="fu">gaussian</span>(<span class="at">link =</span> <span class="st">"identity"</span>))</span>
<span id="cb36-4"><a href="#cb36-4"></a>DHARMa<span class="sc">::</span><span class="fu">simulateResiduals</span>(<span class="at">fittedModel =</span> mod_gaussian, <span class="at">plot =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="fit-poisson-glm-1" class="slide level2">
<h2>Fit Poisson GLM</h2>
<div style="font-size: 0.70em">
<div class="cell" data-hash="06_count_models_cache/revealjs/unnamed-chunk-46_e5af451488244ac1db5b0528a3c8b393">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a>mod_poisson <span class="ot">&lt;-</span> <span class="fu">glm</span>(no_colonies <span class="sc">~</span> growth_medium, <span class="at">data =</span> data, <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="panel-tabset">
<ul id="tabset-5" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-5-1">Diagnostics plot</a></li><li><a href="#tabset-5-2">Code</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1">
<div class="cell" data-hash="06_count_models_cache/revealjs/unnamed-chunk-47_3a4db9fb6949552ab1550b1688771738">
<div class="cell-output-display">
<p><img data-src="06_count_models_files/figure-revealjs/unnamed-chunk-47-1.png" width="960"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Object of Class DHARMa with simulated residuals based on 250 simulations with refit = FALSE . See ?DHARMa::simulateResiduals for help. 
 
Scaled residual values: 0 0.8524651 0 0 0 0 0.0150827 0 0.9098975 1 0 1 0 0 0.73191 0 0 1 1 0 ...</code></pre>
</div>
</div>
</div>
<div id="tabset-5-2">
<div class="cell" data-hash="06_count_models_cache/revealjs/unnamed-chunk-48_d89a3dac281b9e56c76eb478432f57be">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a>mod_poisson <span class="ot">&lt;-</span> <span class="fu">glm</span>(no_colonies <span class="sc">~</span> growth_medium, </span>
<span id="cb39-2"><a href="#cb39-2"></a>                   <span class="at">data =</span> data, </span>
<span id="cb39-3"><a href="#cb39-3"></a>                   <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>))</span>
<span id="cb39-4"><a href="#cb39-4"></a>DHARMa<span class="sc">::</span><span class="fu">simulateResiduals</span>(<span class="at">fittedModel =</span> mod_poisson, <span class="at">plot =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="fit-negative-binomial-glm" class="slide level2">
<h2>Fit Negative Binomial GLM</h2>
<div style="font-size: 0.70em">
<div class="cell" data-hash="06_count_models_cache/revealjs/unnamed-chunk-49_f1526ebae55877a45315414648593118">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a>mod_nb <span class="ot">&lt;-</span> glmmTMB<span class="sc">::</span><span class="fu">glmmTMB</span>(no_colonies <span class="sc">~</span> growth_medium, <span class="at">data =</span> data, <span class="at">family =</span> nbinom2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="panel-tabset">
<ul id="tabset-6" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-6-1">Diagnostics plot</a></li><li><a href="#tabset-6-2">Code</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1">
<div class="cell" data-hash="06_count_models_cache/revealjs/unnamed-chunk-50_2c0cb407e277fa27b849b8a002a0799a">
<div class="cell-output-display">
<p><img data-src="06_count_models_files/figure-revealjs/unnamed-chunk-50-1.png" width="960"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Object of Class DHARMa with simulated residuals based on 250 simulations with refit = FALSE . See ?DHARMa::simulateResiduals for help. 
 
Scaled residual values: 0.2697015 0.7 0.5240064 0.2190504 0.388 0.5970532 0.555846 0.1197963 0.7311763 0.896 0.04313612 0.7635574 0.4581031 0.36 0.704 0.147136 0.268582 0.8364983 0.8777219 0.34 ...</code></pre>
</div>
</div>
</div>
<div id="tabset-6-2">
<div class="cell" data-hash="06_count_models_cache/revealjs/unnamed-chunk-51_e778b0f604020ea6e342ca3e28afb6b6">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a>mod_nb <span class="ot">&lt;-</span> glmmTMB<span class="sc">::</span><span class="fu">glmmTMB</span>(no_colonies <span class="sc">~</span> growth_medium, </span>
<span id="cb42-2"><a href="#cb42-2"></a>                           <span class="at">data =</span> data, </span>
<span id="cb42-3"><a href="#cb42-3"></a>                           <span class="at">family =</span> nbinom2)</span>
<span id="cb42-4"><a href="#cb42-4"></a>DHARMa<span class="sc">::</span><span class="fu">simulateResiduals</span>(<span class="at">fittedModel =</span> mod_nb, <span class="at">plot =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="hypothesis-test-for-growth_medium-effect" class="slide level2">
<h2>Hypothesis test for <code>growth_medium</code> effect</h2>
<div class="panel-tabset">
<ul id="tabset-7" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-7-1">Result</a></li><li><a href="#tabset-7-2">Code</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1">
<div class="cell" data-hash="06_count_models_cache/revealjs/unnamed-chunk-52_ffb8b95967092076044efc89c6f5d78b">
<div class="cell-output cell-output-stdout">
<pre><code>Data: data
Models:
mod_null: no_colonies ~ 1, zi=~0, disp=~1
mod_nb: no_colonies ~ growth_medium, zi=~0, disp=~1
         Df    AIC  BIC  logLik deviance  Chisq Chi Df Pr(&gt;Chisq)   
mod_null  2 1983.5 1990 -989.72   1979.5                            
mod_nb    6 1977.2 1997 -982.63   1965.2 14.198      4    0.00669 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</div>
<div id="tabset-7-2">
<div class="cell" data-hash="06_count_models_cache/revealjs/unnamed-chunk-53_f9c0a6346cea0d2c6be6d6417c612b14">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a>mod_null <span class="ot">&lt;-</span> glmmTMB<span class="sc">::</span><span class="fu">glmmTMB</span>(no_colonies <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> data, <span class="at">family =</span> nbinom2)</span>
<span id="cb44-2"><a href="#cb44-2"></a><span class="fu">anova</span>(mod_null, mod_nb, <span class="at">test =</span> <span class="st">"Chisq"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="multiple-comparisons-1" class="slide level2">
<h2>Multiple comparisons</h2>
<div class="panel-tabset">
<ul id="tabset-8" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-8-1">Result</a></li><li><a href="#tabset-8-2">Code</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1">
<div class="cell" data-hash="06_count_models_cache/revealjs/unnamed-chunk-54_16840a028f4df3926fca9ee66a4cac33">
<div class="cell-output cell-output-stdout">
<pre><code> contrast            estimate    SE  df t.ratio p.value
 medium_a - medium_b   0.5303 0.249 194   2.132  0.2110
 medium_a - medium_c   0.6134 0.249 194   2.465  0.1030
 medium_a - medium_d   0.5728 0.249 194   2.302  0.1486
 medium_a - medium_e   0.8979 0.249 194   3.603  0.0036
 medium_b - medium_c   0.0831 0.249 194   0.334  0.9973
 medium_b - medium_d   0.0425 0.249 194   0.171  0.9998
 medium_b - medium_e   0.3676 0.250 194   1.472  0.5817
 medium_c - medium_d  -0.0406 0.249 194  -0.163  0.9998
 medium_c - medium_e   0.2844 0.250 194   1.139  0.7857
 medium_d - medium_e   0.3250 0.250 194   1.302  0.6905

Results are given on the log (not the response) scale. 
P value adjustment: tukey method for comparing a family of 5 estimates </code></pre>
</div>
</div>
</div>
<div id="tabset-8-2">
<div class="cell" data-hash="06_count_models_cache/revealjs/unnamed-chunk-55_c11112d187ae1abea959c38e659b2411">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a>emmeans<span class="sc">::</span><span class="fu">emmeans</span>(mod_nb, <span class="at">specs =</span> pairwise <span class="sc">~</span> growth_medium)<span class="sc">$</span>contrasts</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="plot-model-predictions" class="slide level2">
<h2>Plot model predictions</h2>
<div class="panel-tabset">
<ul id="tabset-9" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-9-1">Result</a></li><li><a href="#tabset-9-2">Result</a></li></ul>
<div class="tab-content">
<div id="tabset-9-1">
<div class="cell" data-hash="06_count_models_cache/revealjs/unnamed-chunk-56_0e24238ac3eac22efa442f233fbae182">
<div class="cell-output-display">
<p><img data-src="06_count_models_files/figure-revealjs/unnamed-chunk-56-1.png" width="960"></p>
</div>
</div>
</div>
<div id="tabset-9-2">
<div class="cell" data-hash="06_count_models_cache/revealjs/unnamed-chunk-57_26e0b24a46704df245bea8d794fe722c">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a><span class="co"># Extract predictions </span></span>
<span id="cb47-2"><a href="#cb47-2"></a>preds <span class="ot">&lt;-</span></span>
<span id="cb47-3"><a href="#cb47-3"></a>  ggeffects<span class="sc">::</span><span class="fu">ggpredict</span>(</span>
<span id="cb47-4"><a href="#cb47-4"></a>    mod_nb,</span>
<span id="cb47-5"><a href="#cb47-5"></a>    <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"growth_medium"</span>),</span>
<span id="cb47-6"><a href="#cb47-6"></a>    <span class="at">type =</span> <span class="st">"fe"</span>,</span>
<span id="cb47-7"><a href="#cb47-7"></a>    <span class="at">interval =</span> <span class="st">"confidence"</span></span>
<span id="cb47-8"><a href="#cb47-8"></a>    <span class="co"># interval = "prediction"</span></span>
<span id="cb47-9"><a href="#cb47-9"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb47-10"><a href="#cb47-10"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb47-11"><a href="#cb47-11"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">growth_medium =</span> x)</span>
<span id="cb47-12"><a href="#cb47-12"></a></span>
<span id="cb47-13"><a href="#cb47-13"></a><span class="co"># Make plot </span></span>
<span id="cb47-14"><a href="#cb47-14"></a>preds <span class="sc">%&gt;%</span></span>
<span id="cb47-15"><a href="#cb47-15"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> ., <span class="fu">aes</span>(<span class="at">x =</span> growth_medium, <span class="at">y =</span> predicted)) <span class="sc">+</span></span>
<span id="cb47-16"><a href="#cb47-16"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb47-17"><a href="#cb47-17"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high),</span>
<span id="cb47-18"><a href="#cb47-18"></a>              <span class="at">alpha =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb47-19"><a href="#cb47-19"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> data, </span>
<span id="cb47-20"><a href="#cb47-20"></a>             <span class="fu">aes</span>(<span class="at">x =</span> growth_medium, <span class="at">y =</span> no_colonies), </span>
<span id="cb47-21"><a href="#cb47-21"></a>             <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb47-22"><a href="#cb47-22"></a>  <span class="fu">labs</span>(</span>
<span id="cb47-23"><a href="#cb47-23"></a>    <span class="at">x =</span> <span class="st">"Growth medium"</span>,</span>
<span id="cb47-24"><a href="#cb47-24"></a>    <span class="at">y =</span> <span class="st">"Predicted no. of colonies"</span></span>
<span id="cb47-25"><a href="#cb47-25"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p><img src="images/cbc_logo_full.jpg" class="slide-logo"></p>
<div class="footer footer-default">

</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="06_count_models_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="06_count_models_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="06_count_models_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="06_count_models_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="06_count_models_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="06_count_models_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="06_count_models_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="06_count_models_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="06_count_models_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="06_count_models_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        target: function(trigger) {
          return trigger.previousElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto-reveal',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>